unit AutoReopenUnit;interfaceuses	MacOSAll, UtilsTypes, FileUtils, LWPGlobals, LWPEdit, Halda;	procedure DoAutoReopen;	procedure AutoReopenSave;implementationprocedure DoAutoReopen;var	i, b, count: Longint;	recentString, pref: AnsiString;	theFiles, thePositions: StringArr;	selectionStart, selectionEnd: Longint;	err: OSErr;	readOnly: Boolean;	editIndex: Longint;begin	pref := GetPreferencesFolder;	recentString := ReadFileToString(pref + '/LightweightIDEAutoOpenFiles.txt', err);	theFiles := SplitStringToList(recentString);	WriteLn('READING: ', recentString);	recentString := ReadFileToString(pref + '/LightweightIDEAutoOpenFilePos.txt', err);	thePositions := SplitStringToList(recentString);	WriteLn('READING: ', recentString);	for i := 0 to High(theFiles) do	if Length(theFiles[i]) <> 0 then	if Length(thePositions) > i*2 then	if Length(thePositions[i*2]) <> 0 then	begin		selectionStart := 1;		selectionEnd := 1;		if i*2 <= High(thePositions) then			Val(thePositions[i*2], selectionStart);		if i*2+1 <= High(thePositions) then			Val(thePositions[i*2+1], selectionEnd);				editIndex := FindOrOpen(theFiles[i], '');//		EditOpenAndSelect(theFiles[i], selectionStart, selectionEnd);		if editIndex > 0 then		begin						WriteLn('editText = ', editIndex);			WriteLn('selectionStart = ', selectionStart);			WriteLn('selectionEnd = ', selectionEnd);			WriteLn('text length = ', Length(teEdit[editIndex]^.text));			WriteLn('#views = ', Length(teEdit[editIndex]^.views));			WriteLn('focusedView = ', teEdit[editIndex]^.focusedView);			//if selectionEnd < selectionStart then selectionEnd := selectionStart;						HSetSelection(teEdit[editIndex], selectionStart, selectionEnd); //i + columnNumber, i + columnNumber);//WriteLn('1');			if teEdit[editIndex]^.focusedView >= Low(teEdit[editIndex]^.views) then				if teEdit[editIndex]^.focusedView <= High(teEdit[editIndex]^.views) then					HShowSelection(teEdit[editIndex]^.views[teEdit[editIndex]^.focusedView], true);//WriteLn('2');			HInvalViews(teEdit[editIndex]);//WriteLn('3');			UpdateLineNumber(editWind[editIndex]);//WriteLn('4');		end;	end;end;procedure AutoReopenSave;var	i, selectionStart, selectionEnd: Longint;	list: FileArr;	list2: StringArr;	theFiles, thePositions, pref: AnsiString;begin	theFiles := '';	thePositions := '';	list := GetAllEditWindows;	list2 := GetAllEditWindowsSelections;	for i := 0 to High(list) do	if i = High(list) then		theFiles := theFiles + list[i]	else		theFiles := theFiles + list[i] + #13;	for i := 0 to High(list2) do	if i = High(list2) then		thePositions := thePositions + list2[i]	else		thePositions := thePositions + list2[i] + #13;	pref := GetPreferencesFolder;	WriteStringToFile(theFiles, pref + '/LightweightIDEAutoOpenFiles.txt');		WriteStringToFile(thePositions, pref + '/LightweightIDEAutoOpenFilePos.txt');		WriteLn('SAVING: ', theFiles);	WriteLn('SAVING: ', thePositions);end;end.